# ëŒë‹¤ë¥¼ ì´ìš©í•œ ë„ë©”ì¸ ì „ìš© ì–¸ì–´

<div align="center">

> "í”„ë¡œê·¸ë¨ì€ ì‚¬ëŒë“¤ì´ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ì‘ì„±ë˜ì–´ì•¼ í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë©° ê¸°ê¸°ê°€ ì‹¤í–‰í•˜ëŠ” ë¶€ë¶„ì€ ë¶€ì°¨ì ì¼ ë¿"<br /> > \- í•˜ë¡¤ë“œ ì•„ë²¨ìŠ¨

</div>
<br />

- `ë„ë©”ì¸ ì „ìš© ì–¸ì–´(DSL)` : ì‘ì€, ë²”ìš©ì´ ì•„ë‹ˆë¼ íŠ¹ì • ë„ë©”ì¸ì„ ëŒ€ìƒìœ¼ë¡œ ë§Œë“¤ì–´ì§„ íŠ¹ìˆ˜ í”„ë¡œê·¸ë˜ë° ì–¸ì–´
- `í”Œë£¨ì–¸íŠ¸ ìŠ¤íƒ€ì¼(fluent style)` : ìŠ¤íŠ¸ë¦¼ì˜ API íŠ¹ì„±ì¸ ë©”ì„œë“œ ì²´ì¸ì˜ ìœ ì°½í•¨ì„ ë£¨í”„ ì œì–´ì˜ ë³µì¡í•¨ê³¼ ë¹„êµí•˜ì—¬ í”Œë£¨ì–¸íŠ¸ ìŠ¤íƒ€ì¼ì´ë¼ê³  ë¶€ë¦„
  - í”Œë£¨ì–¸íŠ¸ ìŠ¤íƒ€ì¼ì€ ì‰½ê²Œ DSLì— ì ìš©í•  ìˆ˜ ìˆë‹¤
- DSLì„ ë§Œë“œë ¤ë©´
  - ì• í”Œë¦¬ì¼€ì´ì…˜ ìˆ˜ì¤€ í”„ë¡œê·¸ë˜ë¨¸ì—ê²Œ ì–´ë–¤ ë™ì‘ì´ í•„ìš”í•˜ë©° ì´ë“¤ì„ ì–´ë–»ê²Œ í”„ë¡œê·¸ë˜ë¨¸ì—ê²Œ ì œê³µí•˜ëŠ”ì§€ ê³ ë¯¼ì´ í•„ìš”í•˜ë‹¤
  - ì‹œìŠ¤í…œ ìˆ˜ì¤€ì˜ ê°œë…ìœ¼ë¡œ ì¸í•´ ë¶ˆí•„ìš”í•œ ì˜¤ì—¼ì´ ë°œìƒí•˜ì§€ ì•Šë„ë¡ í•´ì•¼ í•¨

# ë„ë©”ì¸ ì „ìš© ì–¸ì–´

- íŠ¹ì • ë¹„ì¦ˆë‹ˆìŠ¤ ë„ë©”ì¸ì˜ ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ê³  ë§Œë“  ì–¸ì–´
- íŠ¹ì • ë¹„ì¦ˆë‹ˆìŠ¤ ë„ë©”ì¸ì„ ì¸í„°í˜ì´ìŠ¤ë¡œ ë§Œë“  API
- DSLì€ ë²”ìš© í”„ë¡œê·¸ë˜ë° ì–¸ì–´ê°€ ì•„ë‹ˆë‹¤
  - ë™ì‘ê³¼ ìš©ì–´ëŠ” íŠ¹ì • ë„ë©”ì¸ì— êµ­í•œëœë‹¤
  - ì˜¤ì§ ìì‹ ì˜ ì•ì— ë†“ì¸ ë¬¸ì œë¥¼ ì–´ë–»ê²Œ í•´ê²°í• ì§€ì—ë§Œ ì§‘ì¤‘í•  ìˆ˜ ìˆë‹¤
- ì €ìˆ˜ì¤€ êµ¬í˜„ ì„¸ë¶€ ì‚¬í•­ ë©”ì„œë“œëŠ” í´ë˜ìŠ¤ì˜ ë¹„ê³µê°œë¡œ ë§Œë“¤ì–´ì„œ ì„¸ë¶€ êµ¬í˜„ ë‚´ìš©ì„ ìˆ¨ê¸¸ ìˆ˜ ìˆë‹¤

## DSLì˜ ì¥ì ê³¼ ë‹¨ì 

<div align="center">

> DSLì€ ë§Œë³‘í†µì¹˜ì•½ì´ ì•„ë‹ˆë‹¤

</div>

### ì¥ì 

- `ê°„ê²°í•¨`
  - ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ìº¡ìŠí™”
  - ë°˜ë³µì„ í”¼í•  ìˆ˜ ìˆê³ , ì½”ë“œë¥¼ ê°„ê²°í•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤
- `ê°€ë…ì„±`
  - ë„ë©”ì¸ ì˜ì—­ì˜ ìš©ì–´ ì‚¬ìš©
  - ë¹„ ë„ë©”ì¸ ì „ë¬¸ê°€ë„ ì½”ë“œë¥¼ ì‰½ê²Œ ì´í•´í•  ìˆ˜ ìˆë‹¤
  - ë‹¤ì–‘í•œ ì¡°ì§ êµ¬ì„±ì› ê°„ì— ì½”ë“œì™€ ë„ë©”ì¸ ì˜ì—­ì´ ê³µìœ ë  ìˆ˜ ìˆë‹¤
- `ìœ ì§€ë³´ìˆ˜`
  - ì˜ ì„¤ê³„ëœ DSLë¡œ êµ¬í˜„í•œ ì½”ë“œëŠ” ì‰½ê²Œ ìœ ì§€ë³´ìˆ˜í•˜ê³  ë°”ê¿€ ìˆ˜ ìˆë‹¤
- `ë†’ì€ ìˆ˜ì¤€ì˜ ì¶”ìƒí™”`
  - ë„ë©”ì¸ê³¼ ê°™ì€ ì¶”ìƒí™” ìˆ˜ì¤€ì—ì„œ ë™ì‘
  - â¡ï¸ ë„ë©”ì¸ì˜ ë¬¸ì œì™€ ì§ì ‘ì ìœ¼ë¡œ ê´€ë ¨ë˜ì§€ ì•Šì€ ì„¸ë¶€ ì‚¬í•­ì„ ìˆ¨ê¹€
- `ì§‘ì¤‘`
  - ë¹„ì¦ˆë‹ˆìŠ¤ ë„ë©”ì¸ì˜ ê·œì¹™ì„ í‘œí˜„í•  ëª©ì ìœ¼ë¡œ ì„¤ê³„ëœ ì–¸ì–´
  - â¡ï¸ í”„ë¡œê·¸ë˜ë¨¸ê°€ íŠ¹ì • ì½”ë“œì— ì§‘ì¤‘ í•  ìˆ˜ ìˆìŒ
  - â¡ï¸ ìƒì‚°ì„±ì´ ì¢‹ì•„ì§
- `ê´€ì‹¬ì‚¬ ë¶„ë¦¬`
  - ì• í”Œë¦¬ì¼€ì´ì…˜ ì¸í”„ë¼ êµ¬ì¡° ë¬¸ì œì™€ ë…ë¦½ì 
  - â¡ï¸ ë¹„ì¦ˆë‹ˆìŠ¤ì™€ ê´€ë ¨ëœ ì½”ë“œì—ë§Œ ì§‘ì¤‘í•˜ê¸°ê°€ ìš©ì´
  - â¡ï¸ ìœ ì§€ë³´ìˆ˜ê°€ ì‰¬ìš´ ì½”ë“œ êµ¬í˜„

### ë‹¨ì 

- `DSL ì„¤ê³„ì˜ ì–´ë ¤ì›€`
  - ê°„ê²°í•˜ê³  ì œí•œì ì¸ ì–¸ì–´ì— ë„ë©”ì¸ ì§€ì‹ì„ ë‹´ëŠ” ê²ƒì´ ì‰¬ìš´ ì‘ì—…ì€ ì•„ë‹˜
- `ê°œë°œ ë¹„ìš©`
  - ì´ˆê¸° í”„ë¡œì íŠ¸ì— ë§ì€ ë¹„ìš©ê³¼ ì‹œê°„ì´ ì†Œëª¨
  - DSLì˜ ìœ ì§€ë³´ìˆ˜ì™€ ë³€ê²½ í•„ìš”
- `ì¶”ê°€ ìš°íšŒ ê³„ì¸µ`
  - DSLì€ ê²°êµ­ ì¶”ê°€ì ì¸ ê³„ì¸µì´ ë„ë©”ì¸ ëª¨ë¸ì„ ê°ì‹¸ëŠ” ê²ƒ
- `ì–¸ì–´ë¥¼ ìƒˆë¡œ ë°°ì›Œì•¼ í•¨`
- `í˜¸ìŠ¤íŒ… ì–¸ì–´ í•œê³„`
  - ìë°”ì™€ ê°™ì€ ì¥í™©í•œ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë§Œë“  DSLì€ ì„±ê°€ì‹  ë¬¸ë²•ì˜ ì œí•œì„ ë°›ê³  ì½ê¸°ê°€ ì–´ë ¤ì›Œì§
  - â¡ï¸ ëŒë‹¤ í‘œí˜„ì‹ìœ¼ë¡œ ì–´ëŠì •ë„ í•´ê²° ê°€ëŠ¥

# DSL ì¹´í…Œê³ ë¦¬

## ë‚´ë¶€ DSL(ì„ë² ë””ë“œ DSL)

- (ìë°” ì–¸ì–´ë¡œ êµ¬í˜„ëœ í”„ë¡œê·¸ë¨ì—ì„œ) ìë°”ë¡œ êµ¬í˜„í•œ DSL
- ëŒë‹¤ë¥¼ ì ê·¹ì ìœ¼ë¡œ í™œìš©í•˜ë©´ ì¥í™©í•¨ì„ í¬ê²Œ ì¤„ì—¬ ì‹ í˜¸ ëŒ€ë¹„ ì¡ìŒ ë¹„ìœ¨ì„ ì ì • ìˆ˜ì¤€ìœ¼ë¡œ ìœ ì§€í•˜ëŠ” ë‚´ë¶€ DSLì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤

```java
List<String> numbers = List.of("one", "two", "three");

// ëŒë‹¤ ì´ì „ ìµëª… ë‚´ë¶€ í´ë˜ìŠ¤
numbers.forEach(new Consumer<String>() {
    @Override
    public void accept(String s) {
        System.out.println(s);
    }
});

// ëŒë‹¤ ì‚¬ìš©
numbers.forEach(System.out::println);
```

- ëŒë‹¤ë¥¼ ì‚¬ìš©í•˜ë©´ íŠ¹ë³„í•œ ê¸°ëŠ¥ì„ í•˜ì§€ ì•Šê³  ë¬¸ë²•ìƒ í•„ìš”í•œ ì¡ìŒì„ ë§ì´ ì¤„ì¼ ìˆ˜ ìˆìŒ

### ë‚´ë¶€ DSL ì¥ì 

- ì™¸ë¶€ DSLì— ë¹„í•´ ìƒˆë¡œìš´ íŒ¨í„´ê³¼ ê¸°ìˆ ì„ ë°°ì›Œ DSLì„ êµ¬í˜„í•˜ëŠ” ë…¸ë ¥ì´ ì¤„ì–´ë“ ë‹¤
- ë‚˜ë¨¸ì§€ ì½”ë“œì™€ í•¨ê»˜ DSLì„ ì»´íŒŒì¼ í•  ìˆ˜ ìˆë‹¤
  - ë‹¤ë¥¸ ì–¸ì–´ì˜ ì»´íŒŒì¼ëŸ¬ë¥¼ ì´ìš©í•˜ê±°ë‚˜ ì™¸ë¶€ DSLì„ ë§Œë“œëŠ” ë„êµ¬ë¥¼ ì‚¬ìš©í•  í•„ìš”ê°€ ì—†ë‹¤
  - â¡ï¸ ì¶”ê°€ë¡œ ë¹„ìš©ì´ ë“¤ì§€ ì•ŠëŠ”ë‹¤
- ìƒˆë¡œìš´ ì–¸ì–´ë¥¼ ë°°ìš°ê±°ë‚œ ìµìˆ™í•˜ì§€ ì•Šê³  ë³µì¡í•œ ì™¸ë¶€ ë„êµ¬ë¥¼ ë°°ìš¸ í•„ìš”ê°€ ì—†ë‹¤
- ê¸°ì¡´ì˜ ìë°” IDEë¥¼ ì´ìš©í•´ ìë™ ì™„ì„±, ìë™ ë¦¬íŒ©í„°ë§ ê°™ì€ ê¸°ëŠ¥ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤
- ì¶”ê°€ DSLì„ ì‰½ê²Œ í•©ì¹  ìˆ˜ ìˆë‹¤

## ë‹¤ì¤‘ DSL

- ë‚´ë¶€ DSLê³¼ ì™¸ë¶€ DSLì˜ ì¤‘ê°„ ì¹´í…Œê³ ë¦¬
- ìŠ¤ì¹¼ë¼ë‚˜ ê·¸ë£¨ë¹„ì²˜ëŸ¼ ìë°”ê°€ ì•„ë‹ˆì§€ë§Œ JVMì—ì„œ ì‹¤í–‰ë˜ë©° ë” ìœ ì—°í•˜ê³  í‘œí˜„ë ¥ì´ ê°•ë ¥í•œ ì–¸ì–´

### ë‹¤ì¤‘ DSL ë‹¨ì 

- ìƒˆë¡œìš´ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë¥¼ ë°°ì›Œì•¼ í•¨
- ë‘ ê°œ ì´ìƒì˜ ì–¸ì–´ í˜¼ì¬ â¡ï¸ ì—¬ëŸ¬ ì»´íŒŒì¼ëŸ¬ë¡œ ì†ŒìŠ¤ë¥¼ ë¹Œë“œí•˜ë„ë¡ ë¹Œë“œ ê³¼ì •ì„ ê°œì„ í•´ì•¼ í•¨
- ìë°”ì™€ í˜¸í™˜ì„±ì´ ì™„ë²½í•˜ì§€ ì•Šì„ ë•Œë„ ìˆìŒ

## ì™¸ë¶€ DSL

- ìì‹ ë§Œì˜ ë¬¸ë²•ê³¼ êµ¬ë¬¸ìœ¼ë¡œ ìƒˆ ì–¸ì–´ë¥¼ ì„¤ê³„í•´ì•¼ í•¨
- ìƒˆ ì–¸ì–´ë¥¼ íŒŒì‹±í•˜ê³ , íŒŒì„œì˜ ê²°ê³¼ë¥¼ ë¶„ì„í•˜ê³ , ì™¸ë¶€ DSLì„ ì‹¤í–‰í•  ì½”ë“œë¥¼ ë§Œë“¤ì–´ì•¼ í•¨
- ì‰½ê²Œ ì œì–´ ë²”ìœ„ë¥¼ ë²—ì–´ë‚  ìˆ˜ ìˆìœ¼ë©° ì²˜ìŒ ì„¤ê³„í•œ ëª©ì ì„ ë²—ì–´ë‚˜ëŠ” ê²½ìš°ê°€ ë§ìŒ

### ì™¸ë¶€ DSL ì¥ì 

- ë¬´í•œí•œ ìœ ì—°ì„± : ìš°ë¦¬ì—ê²Œ í•„ìš”í•œ íŠ¹ì„±ì„ ì™„ë²½í•˜ê²Œ ì œê³µí•˜ëŠ” ì–¸ì–´ë¥¼ ì„¤ê³„í•  ìˆ˜ ìˆë‹¤
- ìë°”ë¡œ ê°œë°œëœ ì¸í”„ë¼êµ¬ì¡° ì½”ë“œì™€ ì™¸ë¶€ DSLë¡œ êµ¬í˜„í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ì½”ë“œë¥¼ ëª…í™•í•˜ê²Œ ë¶„ë¦¬

# ìµœì‹  ìë°” APIì˜ ì‘ì€ DSL

- ëŒë‹¤ì™€ ë©”ì„œë“œ ì°¸ì¡°ë¥¼ ì´ìš©í•œ DSLì€ ê°€ë…ì„±, ì¬ì‚¬ìš©ì„±, ê²°í•©ì„±ì´ ë†’ë‹¤

```java
// ëŒë‹¤ ì´ì „ ë°©ì‹
Collections.sort(persons, new Comparator<Person>() {
    @Override
    public int compare(Person p1, Person p2) {
        return p1.getAge() - p2.getAge();
    }
});

// ëŒë‹¤
persons.sort(Comparator.comparing(Person::getAge));
```

## ìŠ¤íŠ¸ë¦¼ APIëŠ” ì»¬ë ‰ì…˜ì„ ì¡°ì‘í•˜ëŠ” DSL

- Stream ì¸í„°í˜ì´ìŠ¤ëŠ” ë„¤ì´í‹°ë¸Œ ìë°” APIì— ì‘ì€ ë‚´ë¶€ DSLì„ ì ìš©í•œ ì¢‹ì€ ì˜ˆ
- Streamì€ ì»¬ë ‰ì…˜ì˜ í•­ëª©ì„ í•„í„°, ì •ë ¬, ë³€í™˜, ê·¸ë£¹í™”, ì¡°ì‘í•˜ëŠ” ì‘ì§€ë§Œ ê°•í•œ DSL

```java
List<String> errors = Files.lines(Paths.get(fileName))
        .filter(line -> line.startsWith("ERROR"))
        .limit(40)
        .toList();
```

## ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ëŠ” DSLì¸ Collectors

- Collector ì¸í„°í˜ì´ìŠ¤ëŠ” ë°ì´í„° ìˆ˜ì§‘ì„ ìˆ˜í•´í•˜ëŠ” DSL
- ì…‹ ì´ìƒì˜ ì»´í¬ë„ŒíŠ¸ë¥¼ ì¡°í•©í•  ë•ŒëŠ” í”Œë£¨ì–¸íŠ¸ í˜•ì‹ì´ ì¤‘ì²© í˜•ì‹ì— ë¹„í•´ ê°€ë…ì„±ì´ ì¢‹ë‹¤

```java
// ì¤‘ì²© ë°©ì‹
Collector<? super Car, ?, Map<Brand, Map<Color, List<Car>>>> carGroupingCollector =
        groupingBy(Car::getBrand, groupingBy(Car::getColor));

// í”Œë£¨ì–¸íŠ¸ í˜•ì‹ - ìˆœì„œê°€ ëª…í™•
Comparator<Person> comparator = Comparator.comparing(Person::getAge).thenComparing(Person::getName);
```

# ìë°”ë¡œ DSLì„ ë§Œë“œëŠ” íŒ¨í„´ê³¼ ê¸°ë²•

## DSL íŒ¨í„´ ì¥ë‹¨ì 

| íŒ¨í„´                      | ì¥ì                                                                                                                                                                               | ë‹¨ì                                                                                                                                  |
| ------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------ |
| ë©”ì„œë“œ ì²´ì¸               | - ë©”ì„œë“œ ì´ë¦„ì´ í‚¤ì›Œë“œ ì¸ìˆ˜ ì—­í• ì„ í•œë‹¤<br />- ì„ íƒí˜• íŒŒë¼ë¯¸í„°ì™€ ì˜ ë™ì‘í•œë‹¤<br />- DSL ì‚¬ìš©ìê°€ ì •í•´ì§„ ìˆœì„œë¡œ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë„ë¡ ê°•ì œí•  ìˆ˜ ìˆë‹¤<br />- ë¬¸ë²•ì  ì¡ìŒì„ ìµœì†Œí™”í•œë‹¤ | - êµ¬í˜„ì´ ì¥í™©í•˜ë‹¤<br />- í•„ë“œë¥¼ ì—°ê²°í•˜ëŠ” ì ‘ì°© ì½”ë“œê°€ í•„ìš”í•˜ë‹¤<br />- ë“¤ì—¬ì“°ê¸° ê·œì¹™ìœ¼ë¡œë§Œ ë„ë©”ì¸ ê°ì²´ ê³„ì¸µì„ ì •ì˜í•œë‹¤                 |
| ì¤‘ì²© í•¨ìˆ˜                 | - êµ¬í˜„ì˜ ì¥í™©í•¨ì„ ì¤„ì¼ ìˆ˜ ìˆë‹¤<br />- í•¨ìˆ˜ ì¤‘ì²©ìœ¼ë¡œ ë„ë©”ì¸ ê°ì²´ ê³„ì¸µì„ ë°˜ì˜í•œë‹¤                                                                                                   | - ì •ì  ë©”ì„œë“œì˜ ì‚¬ìš©ì´ ë¹ˆë²ˆí•˜ë‹¤<br />- ì´ë¦„ì´ ì•„ë‹Œ ìœ„ì¹˜ë¡œ ì¸ìˆ˜ë¥¼ ì •ì˜í•œë‹¤<br />- ì„ íƒí˜• íŒŒë¼ë¯¸í„°ë¥¼ ì²˜ë¦¬í•  ë©”ì„œë“œ ì˜¤ë²„ë¡œë”©ì´ í•„ìš”í•˜ë‹¤ |
| ëŒë‹¤ë¥¼ ì´ìš©í•œ í•¨ìˆ˜ ì‹œí€€ì‹± | - ì„ íƒí˜• íŒŒë¼ë¯¸í„°ì™€ ì˜ ë™ì‘í•œë‹¤<br />- ì •ì  ë©”ì„œë“œë¥¼ ìµœì†Œí™”í•˜ê±°ë‚˜ ì—†ì•¨ ìˆ˜ ìˆë‹¤<br />- ëŒë‹¤ ì¤‘ì²©ìœ¼ë¡œ ë„ë©”ì¸ ê°ì²´ ê³„ì¸µì„ ë°˜ì˜í•œë‹¤<br />- ë¹Œë”ì˜ ì ‘ì°© ì½”ë“œê°€ ì—†ë‹¤                    | - êµ¬í˜„ì´ ì¥í™©í•˜ë‹¤<br />- ëŒë‹¤ í‘œí˜„ì‹ìœ¼ë¡œ ì¸í•œ ë¬¸ë²•ì  ì¡ìŒì´ DSLì— ì¡´ì¬í•œë‹¤                                                           |

```java
// ë¹„ê°œë°œìì¸ ë„ë©”ì¸ ì „ë¬¸ê°€ê°€ ì´í•´í•˜ê³  ê²€ì¦í•˜ê¸¸ ê¸°ëŒ€í•  ìˆ˜ ì—†ëŠ” ì¥í™©í•œ ì½”ë“œ

Order order = new Order();
order.setCustomer("BigBank");

Trade trade1 = new Trade();
trade1.setType(Type.BUY);

Stock stock1 = new Stock();
stock1.setSymbol("IBM");
stock1.setMarket("NYSE");

trade1.setStock(stock1);
trade1.setPrice(125.00);
trade1.setQuantity(80);
order.addTrade(trade1);

Trade trade2 = new Trade();
trade2.setType(Type.BUY);

Stock stock2 = new Stock();
stock2.setMarket("GOOGLE");
stock1.setMarket("NASDAQ");

trade2.setStock(stock2);
trade2.setPrice(375.00);
trade2.setQuantity(50);
order.addTrade(trade2);
```

## `ë©”ì„œë“œ ì²´ì¸` DSL êµ¬ì„±

```java
public class MethodChainingOrderBuilder {
    public final Order order = new Order();

    private MethodChainingOrderBuilder(String customer) {
        order.setCustomer(customer);
    }

    public static MethodChainingOrderBuilder forCustomer(String customer) {
        return new MethodChainingOrderBuilder(customer);
    }

    public TradeBuilder buy(int quantity) {
        return new TradeBuilder(this, Type.BUY, quantity);
    }

    public TradeBuilder sell(int quantity) {
        return new TradeBuilder(this, Type.SELL, quantity);
    }

    public MethodChainingOrderBuilder addTrader(Trade trade) {
        order.addTrade(trade);
        return this;
    }

    public Order end() {
        return order;
    }
}
```

```java
public class TradeBuilder {
    private final MethodChainingOrderBuilder builder;
    public final Trade trade = new Trade();

    public TradeBuilder(MethodChainingOrderBuilder builder, Trade.Type type, int quantity) {
        this.builder = builder;
        trade.setType(type);
        trade.setQuantity(quantity);
    }

    public StockBuilder stock(String symbol) {
        return new StockBuilder(builder, trade, symbol);
    }
}
```

```java
public class StockBuilder {
    private final MethodChainingOrderBuilder builder;
    private final Trade trade;
    private final Stock stock = new Stock();

    public StockBuilder(MethodChainingOrderBuilder builder, Trade trade, String symbol) {
        this.builder = builder;
        this.trade = trade;
        stock.setSymbol(symbol);
    }

    public TradeBuilderWithStock on(String market) {
        stock.setMarket(market);
        trade.setStock(stock);
        return new TradeBuilderWithStock(builder, trade);
    }
}
```

```java
public class TradeBuilderWithStock {
    private final MethodChainingOrderBuilder builder;
    private final Trade trade;

    public TradeBuilderWithStock(MethodChainingOrderBuilder builder, Trade trade) {
        this.builder = builder;
        this.trade = trade;
    }

    public MethodChainingOrderBuilder at(double price) {
        trade.setPrice(price);
        return builder.addTrader(trade);
    }
}
```

### `ë©”ì„œë“œ ì²´ì¸` DSLì„ í†µí•´ ì£¼ë¬¸í•˜ê¸°

- ì—¬ëŸ¬ ë¹Œë“œ í´ë˜ìŠ¤ë¥¼ ë”°ë¡œ ë§Œë“¦ìœ¼ë¡œì¨ ì‚¬ìš©ìê°€ ë¯¸ë¦¬ ì§€ì •ëœ ì ˆì°¨ì— ë”°ë¼ í”Œë£¨ì–¸íŠ¸ API ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë„ë¡ ê°•ì œí•¨
- ì •ì  ë©”ì„œë“œ ì‚¬ìš©ì„ ìµœì†Œí™”í•˜ê³  ë©”ì„œë“œ ì´ë¦„ì´ ì¸ìˆ˜ì˜ ì´ë¦„ì„ ëŒ€ì‹ í•˜ë„ë¡ ë§Œë“¦
- â¡ï¸ ê°€ë…ì„± ê°œì„ 
- ğŸ’© ë¹Œë”ë¥¼ êµ¬í˜„í•´ì•¼ í•¨
  - ìƒìœ„ ìˆ˜ì¤€ì˜ ë¹Œë”ë¥¼ í•˜ìœ„ ìˆ˜ì¤€ì˜ ë¹Œë”ì™€ ì—°ê²°í•  ë§ì€ ì ‘ì°© ì½”ë“œê°€ í•„ìš”

```java
Order order = MethodChainingOrderBuilder.forCustomer("BigBank")
        .buy(80)
        .stock("IBM")
        .on("NYSE")
        .at(125.00)
        .sell(50)
        .stock("GOOGLE")
        .on("NASDAQ")
        .at(375.00)
        .end();
```

## `ì¤‘ì²©ëœ í•¨ìˆ˜` ì´ìš©í•œ DSL

- ë‹¤ë¥¸ í•¨ìˆ˜ ì•ˆì— í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ë„ë©”ì¸ ëª¨ë¸ì„ ë§Œë“¦

```java
public class NestedFunctionOrderBuilder {
    public static Order order(String customer, Trade... trades) {
        Order order = new Order();
        order.setCustomer(customer);
        Stream.of(trades)
                .forEach(order::addTrade);
        return order;
    }

    public static Trade buy(int quantity, Stock stock, double price) {
        return builderTrade(quantity, stock, price, Type.BUY);
    }

    public static Trade sell(int quantity, Stock stock, double price) {
        return builderTrade(quantity, stock, price, Type.SELL);
    }

    private static Trade builderTrade(int quantity, Stock stock, double price, Trade.Type type) {
        Trade trade = new Trade();
        trade.setQuantity(quantity);
        trade.setType(type);
        trade.setStock(stock);
        trade.setPrice(price);
        return trade;
    }

    public static double at(double price) {
        return price;
    }

    public static Stock stock(String symbol, String market) {
        Stock stock = new Stock();
        stock.setSymbol(symbol);
        stock.setMarket(market);
        return stock;
    }

    public static String on(String market) {
        return market;
    }
}
```

### `ì¤‘ì²©ëœ í•¨ìˆ˜` DSLì„ í†µí•´ ì£¼ë¬¸í•˜ê¸°

- ë„ë©”ì¸ ê°ì²´ ê³„ì¸µ êµ¬ì¡°ì— ê·¸ëŒ€ë¡œ ë°˜ì˜ëœë‹¤
- ğŸ’© ë” ë§ì€ ê´„í˜¸ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤
- ğŸ’© ì¸ìˆ˜ ëª©ë¡ì„ ì •ì  ë©”ì„œë“œì— ë„˜ê²¨ì¤˜ì•¼ í•¨
- ğŸ’© ì¸ìˆ˜ì˜ ì˜ë¯¸ê°€ ì´ë¦„ì´ ì•„ë‹ˆë¼ ìœ„ì¹˜ì— ì˜í•´ ì •ì˜ ë¨

```java
Order order = order("BigBank",
        buy(80,
                stock("IBM", on("NYSE")),
                at(125.00)),
        sell(50,
                stock("GOOGLE", on("NASDAQ")),
                at(375.00)));
```

## `ëŒë‹¤ í‘œí˜„ì‹` ì‚¬ìš© í•¨ìˆ˜ ì‹œí€€ì‹±

```java
public class LambdaOrderBuilder {
    private Order order = new Order();

    public static Order order(Consumer<LambdaOrderBuilder> consumer) {
        LambdaOrderBuilder builder = new LambdaOrderBuilder();
        consumer.accept(builder); // ì „ë‹¬ ë°›ì€ ëŒë‹¤ í‘œí˜„ì‹ ì‹¤í–‰
        return builder.order;
    }

    public void forCustomer(String customer) {
        order.setCustomer(customer);
    }

    public void buy(Consumer<LambdaTradeBuilder> consumer) {
        trade(consumer, Type.BUY);
    }

    public void sell(Consumer<LambdaTradeBuilder> consumer) {
        trade(consumer, Type.SELL);
    }

    private void trade(Consumer<LambdaTradeBuilder> consumer, Trade.Type type) {
        LambdaTradeBuilder builder = new LambdaTradeBuilder();
        builder.trade.setType(type);
        consumer.accept(builder);
        order.addTrade(builder.trade);
    }
}
```

```java
public class LambdaTradeBuilder {
    private Trade trade = new Trade();

    public void quantity(int quantity) {
        trade.setQuantity(quantity);
    }

    public void price(double price) {
        trade.setPrice(price);
    }

    public void stock(Consumer<LambdaStockBuilder> consumer) {
        LambdaStockBuilder builder = new LambdaStockBuilder();
        consumer.accept(builder);
        trade.setStock(builder.stock);
    }
}
```

```java
public class LambdaStockBuilder {
    private Stock stock = new Stock();

    public void symbol(String symbol) {
        stock.setSymbol(symbol);
    }

    public void market(String market) {
        stock.setMarket(market);
    }
}
```

### `ëŒë‹¤ í‘œí˜„ì‹ í•¨ìˆ˜ ì‹œí€€ì‹±` DSLì„ í†µí•´ ì£¼ë¬¸í•˜ê¸°

- ë©”ì„œë“œ ì²´ì¸ íŒ¨í„´(í”Œë£¨ì–¸íŠ¸ ë°©ì‹) + ì¤‘ì²© í•¨ìˆ˜(ë„ë©”ì¸ ê°ì²´ì˜ ê³„ì¸µ êµ¬ì¡° ìœ ì§€)ì˜ ì¥ì ì„ ë”í•¨
- ë§ì€ ì„¤ì • ì½”ë“œ í•„ìš”
- DSL ìì²´ê° ìë°” 8 ëŒë‹¤ í‘œí˜„ì‹ ë¬¸ë²•ì— ì˜í•œ ì¡ìŒì˜ ì˜í–¥ì„ ë°›ìŒ

```java
Order order = LambdaOrderBuilder.order(o -> {
    o.forCustomer("BigBank");
    o.buy(t -> {
        t.quantity(80);
        t.price(125.00);
        t.stock(s -> {
            s.symbol("IBM");
            s.market("NYSE");
        });
    });
    o.sell(t -> {
        t.quantity(50);
        t.price(375.00);
        t.stock(s -> {
            s.symbol("GOOGLE");
            s.market("NASDAQ");
        });
    });
});
```

## ì¡°í•©í•˜ê¸°

- í•œ DSLì— í•œ ê°œì˜ íŒ¨í„´ë§Œ ì‚¬ìš©í•˜ë¼ëŠ” ë²•ì€ ì—†ë‹¤

```java
public class MixedBuilder {
    public static Order forCustomer(String customer, TradeBuilder... builders) {
        Order order = new Order();
        order.setCustomer(customer);
        Stream.of(builders).forEach(b -> order.addTrade(b.trade));
        return order;
    }

    public static TradeBuilder buy(Consumer<TradeBuilder> consumer) {
        return buildTrade(consumer, Type.BUY);
    }

    public static TradeBuilder sell(Consumer<TradeBuilder> consumer) {
        return buildTrade(consumer, Type.SELL);
    }

    private static TradeBuilder buildTrade(Consumer<TradeBuilder> consumer, Trade.Type type) {
        TradeBuilder builder = new TradeBuilder();
        builder.trade.setType(type);
        consumer.accept(builder);
        return builder;
    }
}
```

```java
public class TradeBuilder {
    public Trade trade = new Trade();

    public TradeBuilder quantity(int quantity) {
        trade.setQuantity(quantity);
        return this;
    }

    public TradeBuilder at(double price) {
        trade.setPrice(price);
        return this;
    }

    public StockBuilder stock(String symbol) {
        return new StockBuilder(this, trade, symbol);
    }
}
```

```java
public class StockBuilder {
    private final TradeBuilder builder;
    private final Trade trade;
    private final Stock stock = new Stock();

    public StockBuilder(TradeBuilder builder, Trade trade, String symbol) {
        this.builder = builder;
        this.trade = trade;
        stock.setSymbol(symbol);
    }

    public TradeBuilder on(String market) {
        stock.setMarket(market);
        trade.setStock(stock);
        return builder;
    }
}
```

### `ì¡°í•©ëœ DSL`ë¡œ ì£¼ë¬¸í•˜ê¸°

- ğŸ’© DSLì´ ì—¬ëŸ¬ ê°€ì§€ ê¸°ë²•ì„ í˜¼ìš©í•˜ê³  ìˆìœ¼ë¯€ë¡œ í•œ ê°€ì§€ ê¸°ë²•ì„ ì ìš©í•œ DSLì— ë¹„í•´ ì‚¬ìš©ìê°€ DSLì„ ë°°ìš°ëŠ”ë° ì˜¤ëœ ì‹œê°„ì´ ê±¸ë¦¼

```java
Order order = MixedBuilder.forCustomer("BigBank",
        buy(t -> t.quantity(80)
                .stock("IBM")
                .on("NYSE")
                .at(125.00)),
        sell(t -> t.quantity(50)
                .stock("GOOGLE")
                .on("NASDAQ")
                .at(125.00)));
```

## DSLì— ë©”ì„œë“œ ì°¸ì¡° ì‚¬ìš©

```java
public class Tax {
    public static double regional(double value) {
        return value * 1.1;
    }

    public static double general(double value) {
        return value * 1.3;
    }

    public static double surcharge(double value) {
        return value * 1.05;
    }

    // ì„¸ê¸ˆ ì ìš©í•  ê²ƒì¸ì§€ ê²°ì •í•˜ëŠ” ë¶ˆë¦¬ì–¸ í”Œë˜ê·¸ ì¶”ê°€
    public static double calculate(Order order, boolean userRegional, boolean useGeneral, boolean useSurcharge) {
        double value = order.getValue();
        if (userRegional) value = Tax.regional(value);
        if (useGeneral) value = Tax.general(value);
        if (useSurcharge) value = Tax.surcharge(value);
        return value;
    }
}
```

- ğŸ’©ğŸ’©ğŸ’©ğŸ’© ë¶ˆë¦¬ì–¸ ë³€ìˆ˜ì˜ ì˜¬ë°”ë¥¸ ìˆœì„œ ê¸°ì–µí•˜ê¸° ì–´ë ¤ì›€
- ğŸ’©ğŸ’©ğŸ’©ğŸ’© ì–´ë–¤ ì„¸ê¸ˆì´ ì ìš©ë˜ì—ˆëŠ”ì§€ íŒŒì•…í•˜ê¸° ì–´ë ¤ì›€

```java
public class TaxCalculator {
    private boolean useRegional;
    private boolean useGeneral;
    private boolean useSurcharge;

    public TaxCalculator withTaxRegional() {
        useRegional = true;
        return this;
    }

    public TaxCalculator withTaxGeneral() {
        useGeneral = true;
        return this;
    }

    public TaxCalculator withTaxSurcharge() {
        useSurcharge = true;
        return this;
    }

    public double calculate(Order order) {
        return Tax.calculate(order, useRegional, useGeneral, useSurcharge);
    }
}
```

```java
double value = new TaxCalculator().withTaxRegional()
        .withTaxSurcharge()
        .calculate(order);
```

- ğŸ’©ğŸ’©ğŸ’©ğŸ’© ì½”ë“œê°€ ì¥í™©í•˜ë‹¤
- ğŸ’©ğŸ’©ğŸ’©ğŸ’© ë„ë©”ì¸ì˜ ê° ì„¸ê¸ˆì— í•´ë‹¹í•˜ëŠ” ë¶ˆë¦¬ì–¸ í•„ë“œê°€ í•„ìš” â¡ï¸ í™•ì¥ì„± ì œí•œì 

```java
public class TaxCalculator {
    public DoubleUnaryOperator taxFunction = d -> d;

    public TaxCalculator with(DoubleUnaryOperator f) {
        taxFunction = taxFunction.andThen(f);
        return this;
    }

    public double calculate(Order order) {
        return taxFunction.applyAsDouble(order.getValue());
    }
}
```

```java
double value = new TaxCalculator().with(Tax::regional)
        .with(Tax::surcharge)
        .calculate(order);
```
